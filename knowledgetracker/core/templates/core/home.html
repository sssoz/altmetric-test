{% extends 'base.html' %}
{% load timestamps %}

{% block content %}
<h2>KnowledgeTracker</h2>

<form method="get">
  {{ form }}
  <button type="submit">search</button>
</form>

<hr/>

{% if search_results %}
<section>
  <h3>{{ search_results.query.total }} results for <strong>{{ request.GET.q }}</strong></h3>
  {% for article in search_results.results|dictsortreversed:"score" %}
  <article>
    <h4><a href="{{ article.url }}" target="_blank">{{ article.title }}</a></h4>
    <p>{{ article.type|title }}{% if article.journal %} from <em>{{ article.journal }}</em>{% endif %}</p>
    {% if article.is_oa %}
    <p><strong>Available in Open Access</strong></p>
    {% endif %}
    <dl>
      <dt>Published on</dt>
      <dd>{{ article.published_on|print_timestamp }}</dd>
    </dl>
    <p>
      <a href="{{ article.details_url }}" title="View additional Altmetric data" target="_blank">
        <img src="{{ article.images.medium }}" alt="Donut representation of this articleâ€™s Altmetric Attention Score: {{ article.score }}"/>
      </a>
    </p>
  </article>
  {% empty %}
  {{ search_results.message }}
  {% endfor %}
</section>
{% endif %}

{% endblock %}
